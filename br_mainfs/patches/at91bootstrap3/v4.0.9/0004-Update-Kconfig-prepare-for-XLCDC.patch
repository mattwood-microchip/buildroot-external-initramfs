From 96d4442a42070d7442262b17e7b70e1ec3ad6a49 Mon Sep 17 00:00:00 2001
From: user <xing.chen@microchip.com>
Date: Fri, 16 Aug 2024 18:47:52 +0800
Subject: [PATCH 4/5] Update Kconfig, prepare for XLCDC

---
 Kconfig                  | 53 ++++++++++++++++++++++++++--------------
 device/sam9x60/sam9x60.c |  8 +++++-
 driver/Config.in.driver  |  4 ---
 3 files changed, 41 insertions(+), 24 deletions(-)

diff --git a/Kconfig b/Kconfig
index 1c0e193c..77ca4ea2 100644
--- a/Kconfig
+++ b/Kconfig
@@ -1105,14 +1105,46 @@ config XDMAC
 	default y
 	help
 	  Xdmac support
+
+config LCDC
+	bool "LCDC support"
+	depends on CPU_HAS_LCDC
+	default n
+	help
+	  LCDC support
+
+choice
+	prompt "LCDC IOSET"
+	depends on LCDC
+	default LCDC_IOSET_1 if SAMA5D2
+	default LCDC_IOSET_1_18_BIT if SAM9X6
+	help
+	  Select the LCDC ioset
+
+config LCDC_IOSET_1
+	bool "IOSET 1 for SAMA5D27-SOM1-EK1"
+	depends on SAMA5D2
+
+config LCDC_IOSET_2
+	bool "IOSET 2 for SAMA5D2-XULT"
+	depends on SAMA5D2
+
+config LCDC_IOSET_1_18_BIT
+	bool "IOSET 1 18-bit for SAM9X60-Curiosity"
+	depends on SAM9X60
+
+config LCDC_IOSET_1_24_BIT
+	bool "IOSET 1 24-bit for SAM9X60-EK"
+	depends on SAM9X60
+
+endchoice
 endmenu
 
 menu "Boot logo"
-	depends on CPU_HAS_LCDC
+	depends on LCDC
 
 config LOGO
 	bool "Display logo"
-	select LCDC
 	default n
 	help
 	  Display boot logo in AT91bootstrap
@@ -1173,21 +1205,4 @@ config LOGO_BL_DELAY
 	help
 	  Delay before turn on the backlight
 	  The unit is milliseconds
-
-choice
-	prompt "LCDC IOSET"
-	depends on LOGO && SAMA5D2
-        default LCDC_IOSET_1
-        help
-          Select the LCDC ioset
-
-config LCDC_IOSET_1
-        bool "IOSET 1 for SAMA5D27-SOM1-EK1"
-        depends on SAMA5D2
-
-config LCDC_IOSET_2
-        bool "IOSET 2 for SAMA5D2-XULT"
-        depends on SAMA5D2
-
-endchoice
 endmenu
diff --git a/device/sam9x60/sam9x60.c b/device/sam9x60/sam9x60.c
index eac3d368..023cbbd6 100644
--- a/device/sam9x60/sam9x60.c
+++ b/device/sam9x60/sam9x60.c
@@ -616,31 +616,37 @@ void at91_lcdc_hw_init(void)
 		{"LCDDISP" , AT91C_PIN_PC(24), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDDEN"  , AT91C_PIN_PC(29), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDPCK"  , AT91C_PIN_PC(30), 0, PIO_DEFAULT, PIO_PERIPH_A},
+#ifdef CONFIG_LCDC_IOSET_1_24_BIT
 		{"LCDD0"   , AT91C_PIN_PC(0) , 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD1"   , AT91C_PIN_PC(1) , 0, PIO_DEFAULT, PIO_PERIPH_A},
+#endif
 		{"LCDD2"   , AT91C_PIN_PC(2) , 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD3"   , AT91C_PIN_PC(3) , 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD4"   , AT91C_PIN_PC(4) , 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD5"   , AT91C_PIN_PC(5) , 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD6"   , AT91C_PIN_PC(6) , 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD7"   , AT91C_PIN_PC(7) , 0, PIO_DEFAULT, PIO_PERIPH_A},
+#ifdef CONFIG_LCDC_IOSET_1_24_BIT
 		{"LCDD8"   , AT91C_PIN_PC(8) , 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD9"   , AT91C_PIN_PC(9) , 0, PIO_DEFAULT, PIO_PERIPH_A},
+#endif
 		{"LCDD10"  , AT91C_PIN_PC(10), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD11"  , AT91C_PIN_PC(11), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD12"  , AT91C_PIN_PC(12), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD13"  , AT91C_PIN_PC(13), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD14"  , AT91C_PIN_PC(14), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD15"  , AT91C_PIN_PC(15), 0, PIO_DEFAULT, PIO_PERIPH_A},
+#ifdef CONFIG_LCDC_IOSET_1_24_BIT
 		{"LCDD16"  , AT91C_PIN_PC(16), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD17"  , AT91C_PIN_PC(17), 0, PIO_DEFAULT, PIO_PERIPH_A},
+#endif
 		{"LCDD18"  , AT91C_PIN_PC(18), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD19"  , AT91C_PIN_PC(19), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD20"  , AT91C_PIN_PC(20), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD21"  , AT91C_PIN_PC(21), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD22"  , AT91C_PIN_PC(22), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{"LCDD23"  , AT91C_PIN_PC(23), 0, PIO_DEFAULT, PIO_PERIPH_A},
-		{"LCDPWM" , AT91C_PIN_PC(26), 0, PIO_DEFAULT, PIO_PERIPH_A},
+		{"LCDPWM"  , AT91C_PIN_PC(26), 0, PIO_DEFAULT, PIO_PERIPH_A},
 		{(char *)0, 0, 0, PIO_DEFAULT, PIO_PERIPH_A},
 	};
 	pio_configure(lcdc_pins);
diff --git a/driver/Config.in.driver b/driver/Config.in.driver
index 92de7ddf..7a0b01ec 100644
--- a/driver/Config.in.driver
+++ b/driver/Config.in.driver
@@ -126,10 +126,6 @@ config CPU_HAS_XDMAC
 	bool
 	default n
 
-config LCDC
-	bool
-	default n
-
 config CPU_HAS_LCDC
 	bool
 	default n
-- 
2.34.1

